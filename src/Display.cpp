#include <config.h>
#include <Display.h>

Adafruit_PCD8544 adafruitDisplay(CLK, DIN, DC, CE, RST);

Display::Display() {
}

void Display::setup() {
  adafruitDisplay.begin();
  adafruitDisplay.setContrast(60);
  adafruitDisplay.setTextColor(COLOR);
  adafruitDisplay.clearDisplay();
}

void Display::println(String text, int size = 1, int x = 0, int y = 0) {
  adafruitDisplay.clearDisplay();
  adafruitDisplay.setTextWrap(true);
  adafruitDisplay.setCursor(x, y);
  adafruitDisplay.setTextSize(size);
  adafruitDisplay.println(text);
  Serial.println(text);
  adafruitDisplay.display();
}

void Display::printDashboard(String dateNow, String temperature, String humidity, String startTime, String stopTime) {
  adafruitDisplay.clearDisplay();
  adafruitDisplay.setTextWrap(true);

  adafruitDisplay.setTextSize(1);
  adafruitDisplay.setCursor(26, 0);
  adafruitDisplay.println(dateNow);

  adafruitDisplay.setTextSize(1);
  adafruitDisplay.setCursor(2, 17);
  adafruitDisplay.println(startTime);

  adafruitDisplay.setTextSize(1);
  adafruitDisplay.setCursor(50, 17);
  adafruitDisplay.println(stopTime);

  adafruitDisplay.setTextSize(2);
  adafruitDisplay.setCursor(2, 32);
  adafruitDisplay.println(temperature);
  adafruitDisplay.setTextSize(1);
  adafruitDisplay.setCursor(25, 39);
  adafruitDisplay.println("C");

  adafruitDisplay.setTextSize(2);
  adafruitDisplay.setCursor(50, 32);
  adafruitDisplay.println(humidity);
  adafruitDisplay.setTextSize(1);
  adafruitDisplay.setCursor(75, 39);
  adafruitDisplay.println("%");

  adafruitDisplay.display();
}

void Display::splash() {
  const unsigned char picture [] = {
    0xff, 0xff, 0xff, 0xff, 0xfc, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0x01,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xf8, 0x00, 0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x01, 0x00, 0x0f, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x01, 0x80, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xc0,
    0x01, 0x80, 0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x80, 0x03, 0x80, 0x01, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0x00, 0x03, 0xc0, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0x03, 0xc0,
    0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0x03, 0xc0, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff,
    0xfc, 0x00, 0x03, 0xc0, 0x04, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0x07, 0xe0, 0x0c, 0x3f,
    0xff, 0xff, 0xff, 0xff, 0xf8, 0x30, 0x07, 0xe0, 0x1c, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x38,
    0x07, 0xe0, 0x38, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x1c, 0x07, 0xe0, 0x78, 0x1f, 0xff, 0xff,
    0xff, 0xff, 0xf8, 0x1e, 0x07, 0xe0, 0xf0, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x0f, 0x87, 0xc1,
    0xf0, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x07, 0x83, 0xc3, 0xe0, 0x0f, 0xff, 0xff, 0xff, 0xff,
    0xf0, 0x07, 0xc3, 0xc7, 0xc0, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xf0, 0x03, 0xe3, 0xc7, 0x80, 0x0f,
    0xff, 0xff, 0xff, 0xff, 0xf0, 0x01, 0xf3, 0xcf, 0x80, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00,
    0xf3, 0xdf, 0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00, 0x7b, 0xde, 0x00, 0x1f, 0xff, 0xff,
    0xff, 0xff, 0xf8, 0x00, 0x3f, 0xbc, 0x00, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x7c, 0x1d, 0xb8,
    0x7c, 0x1f, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x1f, 0xcf, 0xf3, 0xf8, 0x1f, 0xff, 0xff, 0xff, 0xff,
    0xfc, 0x07, 0xf7, 0x6f, 0xc0, 0x3f, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x00, 0xff, 0xbe, 0x00, 0x3f,
    0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0x0f, 0xc0, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00,
    0x3f, 0x7c, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01, 0xf1, 0x0f, 0x00, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0x80, 0x01, 0x00, 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xc0, 0x01, 0x00,
    0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe0, 0x01, 0x00, 0x07, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xf0, 0x01, 0x00, 0x0f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0x00, 0x00, 0x1f, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xfe, 0x00, 0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xc0, 0x03, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0x3f, 0xff, 0xff, 0xff, 0xff
  };

  adafruitDisplay.clearDisplay();
  adafruitDisplay.drawBitmap(2, 2, picture, 80, 40, 1);
  adafruitDisplay.display();
}

Display display = Display();
